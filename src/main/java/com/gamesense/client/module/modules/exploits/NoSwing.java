package com.gamesense.client.module.modules.exploits;

import com.gamesense.api.event.events.PacketEvent;
import com.gamesense.api.setting.values.BooleanSetting;
import com.gamesense.client.module.Category;
import com.gamesense.client.module.Module;
import me.zero.alpine.listener.EventHandler;
import me.zero.alpine.listener.Listener;
import net.minecraft.network.play.client.CPacketAnimation;
import net.minecraft.util.EnumHand;

@Module.Declaration(name = "NoSwing", category = Category.Exploits)
public class NoSwing extends Module {

    BooleanSetting offhandSwing = registerBoolean("Offhand Swing", false);
    BooleanSetting client = registerBoolean("Client", true);
    BooleanSetting server = registerBoolean("Server", false);
    @EventHandler
    private final Listener<PacketEvent.Send> listener = new Listener<>(event -> {
        if (event.getPacket() instanceof CPacketAnimation && server.getValue()) {

            event.cancel();

            if (offhandSwing.getValue()) {
                mc.player.isSwingInProgress = false;
                mc.player.swingProgressInt = 0;
                mc.player.swingProgress = 0.0f;
                mc.player.prevSwingProgress = 0.0f;
                mc.player.swingArm(EnumHand.OFF_HAND);
            }
        }
    });

    @SuppressWarnings("unused")
    public void onUpdate() {

        if (client.getValue()) {

            mc.player.isSwingInProgress = false;
            mc.player.swingProgressInt = 0;
            mc.player.swingProgress = 0.0f;
            mc.player.prevSwingProgress = 0.0f;

        }
    }
}